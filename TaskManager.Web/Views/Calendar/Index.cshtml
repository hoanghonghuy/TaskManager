@model TaskManager.Web.ViewModels.CalendarViewModel

@{
    ViewData["Title"] = "Lịch";
}

<div class="container-fluid mt-4">
    <div class="calendar-header mb-4 d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
            <h1 class="text-white">Tháng @Model.MonthName @Model.Year</h1>
        </div>
        <div class="btn-group">
            <a class="btn btn-secondary" asp-action="Index" asp-route-month="@(Model.Month - 1 == 0 ? 12 : Model.Month - 1)" asp-route-year="@(Model.Month - 1 == 0 ? Model.Year - 1 : Model.Year)">
                <i class="bi bi-chevron-left"></i>
            </a>
            <a class="btn btn-secondary" asp-action="Index" asp-route-month="@(Model.Month + 1 == 13 ? 1 : Model.Month + 1)" asp-route-year="@(Model.Month + 1 == 13 ? Model.Year + 1 : Model.Year)">
                <i class="bi bi-chevron-right"></i>
            </a>
        </div>
    </div>

    <div class="calendar-grid">
        <div class="calendar-week-header">
            <div class="day-of-week">T2</div>
            <div class="day-of-week">T3</div>
            <div class="day-of-week">T4</div>
            <div class="day-of-week">T5</div>
            <div class="day-of-week">T6</div>
            <div class="day-of-week">T7</div>
            <div class="day-of-week">CN</div>
        </div>
        <div class="calendar-days">
            @foreach (var day in Model.DaysInGrid)
            {
                <div class="day-cell @(day.Month != Model.Month ? "text-muted" : "") @(day == DateTime.Today.Date ? "today-highlight" : "")">
                    <div class="day-number">@day.Day</div>
                    @if (Model.TasksByDay.ContainsKey(day.Date))
                    {
                        @foreach (var task in Model.TasksByDay[day.Date])
                        {
                            <a class="task-item" asp-controller="Tasks" asp-action="Details" asp-route-id="@task.Id">@task.Title</a>
                        }
                    }
                </div>
            }
        </div>
    </div>
</div>

<style>
    .calendar-grid {
        display: grid;
        grid-template-rows: auto 1fr;
        border: 1px solid #444;
        border-radius: 8px;
        overflow: hidden;
    }

    .calendar-week-header {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        background-color: #2e2e2e;
        color: #ddd;
        font-weight: bold;
        text-align: center;
        padding: 10px 0;
        border-bottom: 1px solid #444;
    }

    .calendar-days {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        grid-auto-rows: minmax(120px, auto);
        color: #d1d5db;
        border-right: 1px solid #444;
    }

    .day-cell {
        padding: 8px;
        border-bottom: 1px solid #444;
        border-left: 1px solid #444;
        position: relative;
    }

        .day-cell:nth-child(7n+1) {
            border-left: none;
        }

    .day-number {
        font-weight: bold;
        color: #999;
        margin-bottom: 5px;
    }

    .today-highlight {
        background-color: #333;
    }

    .task-item {
        display: block;
        background-color: #0d6efd;
        color: white;
        padding: 2px 6px;
        margin-top: 5px;
        border-radius: 4px;
        font-size: 12px;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }
</style>